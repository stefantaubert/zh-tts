# zho-tts

[![PyPI](https://img.shields.io/pypi/v/zho-tts.svg)](https://pypi.python.org/pypi/zho-tts)
![PyPI](https://img.shields.io/pypi/pyversions/zho-tts.svg)
[![Hugging Face ðŸ¤—](https://img.shields.io/badge/%20%F0%9F%A4%97_Hugging_Face-zho--tts-blue.svg)](https://huggingface.co/spaces/stefantaubert/zho-tts)
[![pytorch](https://img.shields.io/badge/PyTorch_2.0+-ee4c2c?logo=pytorch&logoColor=white)](https://pytorch.org/get-started/pytorch-2.0/)
[![MIT](https://img.shields.io/github/license/stefantaubert/zh-tts.svg)](https://github.com/stefantaubert/zh-tts/blob/master/LICENSE)
[![PyPI](https://img.shields.io/pypi/wheel/zho-tts.svg)](https://pypi.python.org/pypi/zho-tts/#files)
![PyPI](https://img.shields.io/pypi/implementation/zho-tts.svg)
[![PyPI](https://img.shields.io/github/commits-since/stefantaubert/zh-tts/latest/master.svg)](https://github.com/stefantaubert/zh-tts/compare/v0.0.1...master)
[![DOI](https://zenodo.org/badge/DOI/10.5281/zenodo.10512789.svg)](https://doi.org/10.5281/zenodo.10512789)

Web app, command-line interface and Python library for synthesizing Chinese texts into speech.

## Installation

```sh
pip install zho-tts --user
```

## Usage as web app

Visit [ðŸ¤— Hugging Face](https://huggingface.co/spaces/stefantaubert/zh-tts) for a live demo.

<a href="https://huggingface.co/spaces/stefantaubert/zho-tts">
<img src="https://github.com/stefantaubert/zh-tts/raw/master/img/hf.png" alt="Screenshot Hugging Face" style="max-width: 600px; width: 100%"/>
</a>

You can also run it locally be executing `zho-tts-web` in CLI and opening your browser on [http://127.0.0.1:7860](http://127.0.0.1:7860).

## Usage as CLI

```sh
zho-tts-cli synthesize "é•¿æ±Ÿ èˆªåŠ¡ ç®¡ç†å±€ å’Œ é•¿æ±Ÿ è½®èˆ¹ æ€»å…¬å¸ æœ€è¿‘ å†³å®š å®‰æŽ’ ä¸€ç™¾ä¸‰åä¸‰ è‰˜ å®¢è½® è¿ŽæŽ¥ é•¿æ±Ÿ å¹²çº¿ æ˜¥è¿ã€‚"
```

The output can be listened [here](https://github.com/stefantaubert/zh-tts/raw/master/examples/synthesize.wav).

```sh
# Same example using IPA input
zho-tts-cli synthesize-ipa "ÊˆÊ‚Ë|aË§Ë©Ë§Ë˜|Å‹|tÉ•Ë˜|j|aË¥Ë˜|Å‹Ë˜|SIL0|x|aË§Ë¥Ë˜|Å‹|uË¥Ë©|SIL0|k|w|aË§Ë©Ë§|n|lË˜|iË§Ë©Ë§|tÉ•Ë|yË§Ë¥Ë‘|SIL0|x|É¤Ë§Ë¥|SIL0|ÊˆÊ‚Ë|aË§Ë©Ë§Ë˜|Å‹|tÉ•Ë˜|j|aË¥Ë˜|Å‹|SIL0|l|w|É™Ë§Ë¥|n|ÊˆÊ‚Ê°Ë˜|w|aË§Ë¥|n|SIL0|tsË˜|ÊŠË§Ë©Ë§|Å‹Ë˜|kË|ÊŠË¥|Å‹|s|É¹Ì©Ë¥Ë‘|SIL0|ts|wË˜|eiÌ¯Ë¥Ë©|tÉ•|iË¥Ë©Ë˜|n|SIL0|tÉ•|É¥|eË§Ë¥|t|iË¥Ë©|Å‹|SIL3|aË¥|n|pÊ°|aiÌ¯Ë§Ë¥|SIL0|iË¥Ë‘|p|aiÌ¯Ë§Ë©Ë§|s|aË¥Ë˜|n|Ê‚Ë˜|É»Ì©Ë§Ë¥|s|aË¥|n|SIL0|sË˜|ouÌ¯Ë¥|SIL0|kÊ°Ë‘|É¤Ë¥Ë©|lË|wË‘|É™Ë§Ë¥Ë‘|n|SIL0|iË§Ë¥Ë|Å‹|tÉ•Ë˜|jË˜|eË¥|SIL0|ÊˆÊ‚Ë|aË§Ë©Ë§|Å‹|tÉ•Ë˜|j|aË¥Ë˜|Å‹|SIL0|kË˜|aË¥Ë©|n|É•|jË˜|É›Ë¥Ë©|nË˜|SIL0|ÊˆÊ‚Ê°Ë‘|wË˜|É™Ë¥Ë˜|nË|yË¥Ë©Ë‘|nË|ã€‚"
```

The output can be listened [here](https://github.com/stefantaubert/zh-tts/raw/master/examples/synthesize-ipa.wav).

## Usage as library

```py
from pathlib import Path
from tempfile import gettempdir

from zho_tts import Synthesizer, Transcriber, normalize_audio, save_audio

text = "é•¿æ±Ÿ èˆªåŠ¡ ç®¡ç†å±€ å’Œ é•¿æ±Ÿ è½®èˆ¹ æ€»å…¬å¸ æœ€è¿‘ å†³å®š å®‰æŽ’ ä¸€ç™¾ä¸‰åä¸‰ è‰˜ å®¢è½® è¿ŽæŽ¥ é•¿æ±Ÿ å¹²çº¿ æ˜¥è¿ã€‚"

transcriber = Transcriber()
synthesizer = Synthesizer()

text_ipa = transcriber.transcribe_to_ipa(text)
audio = synthesizer.synthesize(text_ipa)

tmp_dir = Path(gettempdir())
save_audio(audio, tmp_dir / "output.wav")

# Optional: normalize output
normalize_audio(tmp_dir / "output.wav", tmp_dir / "output_norm.wav")
```

## Model info

The used TTS model is published [here](https://doi.org/10.5281/zenodo.10209990).

### Phoneme set

- Vowels: a É› e É™ Éš É¤ i o u ÊŠ y
- Diphthongs: aiÌ¯ auÌ¯ eiÌ¯ ouÌ¯
- Consonants: f j k kÊ° l m n p pÊ° É¹Ì©Â¹ É»Â¹ É»Ì©Â¹ s t ts tsÊ° tÉ• tÉ•Ê° tÊ° w x Å‹ É• É¥ Ê‚ ÊˆÊ‚ ÊˆÊ‚Ê°
- Breaks:
  - SIL0 (no break)
  - SIL1 (short break)
  - SIL2 (break)
  - SIL3 (long break)
- special characters: ã€‚ ?

Vowels and diphthongs contain one of these tones:

- Ë¥ (first tone)
- Ë§Ë¥ (second tone)
- Ë§Ë©Ë§ (third tone)
- Ë¥Ë© (fourth tone)
- (none)

Â¹ These consonants contain also tones.

Vowels, diphthongs and consonants contain one of these duration markers:

- Ë˜ -> very short, e.g., ouÌ¯Ë˜
- nothing -> normal, e.g., ouÌ¯
- Ë‘ -> half long, e.g., ouÌ¯Ë‘
- Ë -> long, e.g., ouÌ¯Ë

Tones and duration markers can be combined, e.g., É™Ë§Ë¥Ë

### Speakers

![Objective Evaluation](https://github.com/stefantaubert/zh-tts/raw/master/img/eval.png)

## Citation

If you want to cite this repo, you can use the BibTeX-entry generated by GitHub (see *About => Cite this repository*).

- Taubert, S. (2024). zho-tts (Version 0.0.1) [Computer software]. [https://doi.org/10.5281/zenodo.10512789](https://doi.org/10.5281/zenodo.10512789)

## Acknowledgments

Funded by the Deutsche Forschungsgemeinschaft (DFG, German Research Foundation) â€“ Project-ID 416228727 â€“ CRC 1410

The authors gratefully acknowledge the GWK support for funding this project by providing computing time through the Center for Information Services and HPC (ZIH) at TU Dresden.

The authors are grateful to the Center for Information Services and High Performance Computing [Zentrum fur Informationsdienste und Hochleistungsrechnen (ZIH)] at TU Dresden for providing its facilities for high throughput calculations.
